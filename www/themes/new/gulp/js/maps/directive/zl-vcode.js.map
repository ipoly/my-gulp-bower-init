{"version":3,"sources":["directive/zl-vcode.coffee"],"names":[],"mappings":"AAAA;AAAA,EAAA,cAAA,CAAA;AAAA,EAEA,OAAO,CAAC,MAAR,CAAe,oBAAf,EAAoC,EAApC,CACA,CAAC,SADD,CACW,SADX,EACsB;IACpB,UADoB,EAEpB,SAAC,QAAD,GAAA;aACE;AAAA,QAAA,QAAA,EAAU,GAAV;AAAA,QACA,OAAA,EAAS,IADT;AAAA,QAEA,KAAA,EACE;AAAA,UAAA,MAAA,EAAQ,GAAR;SAHF;AAAA,QAIA,QAAA,EAAU,oGAJV;AAAA,QAOA,IAAA,EAAM,SAAC,MAAD,EAAS,IAAT,EAAe,KAAf,GAAA;AACJ,cAAA,iDAAA;;YAAA,MAAM,CAAC,SAAU;WAAjB;AAAA,UACA,MAAA,GAAS;AAAA,YAAC,OAAA,EAAS,CAAV;AAAA,YAAa,MAAA,EAAQ,MAArB;WADT,CAAA;AAAA,UAEA,MAAM,CAAC,IAAP,GAAc,WAAA,GAAc,OAF5B,CAAA;AAAA,UAGA,UAAA,GAAa,SAHb,CAAA;AAAA,UAIA,KAAA,GAAQ,IAJR,CAAA;AAAA,UAMA,SAAA,GAAY,SAAC,IAAD,GAAA;AACV,gBAAA,MAAA;;cADW,OAAK;aAChB;AAAA,YAAA,MAAM,CAAC,MAAP,GAAgB,IAAhB,CAAA;AAAA,YACA,QAAQ,CAAC,MAAT,CAAgB,KAAhB,CADA,CAAA;AAAA,YAGA,MAAA,GAAS,SAAA,GAAA;AACP,cAAA,MAAM,CAAC,IAAP,GAAc,IAAA,EAAA,GAAS,UAAvB,CAAA;AACA,cAAA,IAAG,IAAA,KAAQ,CAAX;AACE,gBAAA,MAAM,CAAC,IAAP,GAAc,WAAd,CAAA;uBACA,MAAM,CAAC,MAAP,GAAgB,MAFlB;eAAA,MAAA;uBAIE,KAAA,GAAQ,QAAA,CAAS,MAAT,EAAiB,IAAjB,EAJV;eAFO;YAAA,CAHT,CAAA;mBAWA,MAAA,CAAA,EAZU;UAAA,CANZ,CAAA;AAAA,UAoBA,MAAM,CAAC,MAAP,CAAc,QAAd,EAAwB,SAAC,MAAD,GAAA;mBACtB,KAAK,CAAC,IAAN,CAAW,UAAX,EAAuB,MAAA,IAAU,MAAM,CAAC,OAAO,CAAC,KAAf,CAAqB,KAAK,CAAC,UAA3B,CAAjC,EADsB;UAAA,CAAxB,CApBA,CAAA;iBAuBA,MAAM,CAAC,IAAP,GAAc,SAAA,GAAA;mBACZ,CAAC,CAAC,IAAF,CAAO,uBAAP,EAAgC,OAAO,CAAC,MAAR,CAAe,MAAf,EAAuB,MAAM,CAAC,MAA9B,CAAhC,CACA,CAAC,IADD,CACM,SAAC,IAAD,GAAA;AACJ,cAAA,KAAA,CAAM,IAAN,CAAA,CAAA;qBACA,SAAA,CAAU,EAAV,EAFI;YAAA,CADN,EADY;UAAA,EAxBV;QAAA,CAPN;QADF;IAAA,CAFoB;GADtB,CAFA,CAAA;AAAA","file":"directive/zl-vcode.js","sourceRoot":"/source/","sourcesContent":["\"use restrict\"\n# generate progress bar\nangular.module 'zl-vcode.directive',[]\n.directive 'zlVcode', [\n  '$timeout'\n  ($timeout)->\n    restrict: 'E'\n    replace: true\n    scope:\n      params: '='\n    template: \"\"\"\n      <button type='button' ng-click='send()' ng-class='{\"font-size-small\": active}'>{{text}}</button>\n    \"\"\"\n    link: ($scope, $elm, $attr)->\n      $scope.params ?= {}\n      params = {'Rc5vc': 1, 'type': 'ajax'}\n      $scope.text = defaultText = '发送验证码'\n      activeText = ' 秒后可再获取'\n      timer = null\n\n      countDown = (time=60)->\n        $scope.active = true\n        $timeout.cancel timer\n\n        update = ->\n          $scope.text = time-- + activeText\n          if time is 0\n            $scope.text = defaultText\n            $scope.active = false\n          else\n            timer = $timeout update ,1000\n\n        update()\n\n      $scope.$watch 'active', (active)->\n        $attr.$set 'disabled', active or $scope.$parent.$eval($attr.ngDisabled)\n\n      $scope.send = ->\n        $.post '/index.php?user&q=reg', angular.extend params, $scope.params\n        .done (data)->\n          alert data\n          countDown(60)\n\n]"]}